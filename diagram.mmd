flowchart TB
  %% External
  Internet["Internet Users\n(Clients)"]
  Admin["Admin / Enterprise VPN / SSM"]
  CDN["CDN (CloudFront)\nOptional"]
  CICD["CI/CD (GitHub Actions / CodePipeline)"]

  %% VPC / Networking
  subgraph VPC["Production VPC â€” Multi-AZ"]
    direction TB
    IGW["Internet Gateway"]
    NAT1["NAT Gateway (AZ1)"]
    NAT2["NAT Gateway (AZ2)"]
    RT_PUB["Public Route Table"]
    RT_PRV["Private Route Table"]
    NACL["Network ACLs"]
    VPCFlow["VPC Flow Logs -> CloudWatch / S3"]

    subgraph AZ1["AZ-1"]
      PUB1["Public Subnet (AZ-1)"]
      PRV1["Private App Subnet (AZ-1)"]
      DB1["Private DB Subnet (AZ-1)"]
    end

    subgraph AZ2["AZ-2"]
      PUB2["Public Subnet (AZ-2)"]
      PRV2["Private App Subnet (AZ-2)"]
      DB2["Private DB Subnet (AZ-2)"]
    end
  end

  %% Public tier
  ALB["Internet-facing ALB\n(TLS termination)"]
  WAF["WAF (attached to ALB)"]
  Shield["AWS Shield"]
  Bastion["Bastion / Jump Host\n(SSM preferred)"]
  ECR["ECR (Private registry)"]
  S3_Static["S3 (Static Assets)\nVersioned & Encrypted"]

  %% EKS control plane + IAM
  EKS_Cluster["Amazon EKS Cluster\n(Private endpoint)"]
  subgraph EKS_Control["EKS Control Plane & IAM"]
    CP["Managed control plane"]
    OIDC["IAM OIDC Provider"]
    IRSA["IRSA (service-account roles)"]
  end

  %% Compute
  subgraph Compute["EKS Compute (private subnets)"]
    NG_App["Node Group: app (spot + on-demand)"]
    NG_System["Node Group: system (on-demand)"]
    Fargate["Fargate Profiles (optional)"]
    CA["Cluster Autoscaler"]
    HPA["Horizontal Pod Autoscaler (HPA)"]
    ServiceMesh["Service Mesh (Istio/Linkerd)"]
    NetPol["NetworkPolicies (Calic]()
